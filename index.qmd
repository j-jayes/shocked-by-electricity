---
title: "Shocked by electricity: The impact of new technology on individuals and local labour markets"
subtitle: "EHES Vienna 2023 -Session 7 Room 8"
author: "Jonathan Jayes  - Lund University"
title-slide-attributes:
  data-background-image: "assets/preview_wide.png"
  data-background-position: "bottom 10"
  data-background-size: "90%"
  data-background-opacity: "0.4"
format: 
  revealjs:
    code-overflow: wrap
    width: 1600
    height: 900
    fig-align: center
    default-image-extension: svg
    footer: "[{{< fa house >}}](https://interludeone.com/content/research.html)"
    slide-number: c
    code-block-bg: true
    code-block-border-left: "#31BAE9"
    include-in-header: 
        - text: <link rel = "shortcut icon" href = "assets/favicon.ico" />

image: "assets/preview_wide.png"
favicon: "assets/favicon.ico"
execute: 
  eval: true
  echo: false

---

# Research question{#sec-researchquestion background-color="#1C9E77"}

<br>

How does getting access to new technology (electricity) impact your returns on the labour market, in terms of:

- Income, 
- Occupational choice, and 
- Choice on where to locate?

# Motivation{#sec-motivation background-color="#1C9E77"}

Why do we care about the second industrial revolution?

## New electrical machinery in agriculture

![](assets/2IR_1.JPG){fig-align="center"}

## New electrical machinery in manufacturing{visibility="uncounted"}

![](assets/2IR_2.JPG){fig-align="center"}

## New technology with rapid adoption in Sweden

![](assets/schon-energy-share.jpeg){fig-align="center"}

# Who were the early electrifiers in Sweden?{#sec-early background-color="#1C9E77"}

## How do we know who the early electrifiers in Sweden were?

<br>

:::: {.columns}

::: {.column width="50%"}

#### Individual level census data

![](assets/1930_census.png){fig-align="center"}

:::

::: {.column width="50%"}

#### Geographical variation in electrification

![](assets/electricity_map.png){fig-align="center"}


:::

::::

## Who were the early electrifiers in Sweden?

![](assets/map_big_power_stations.jpeg){fig-align="center"}

## Grid 1900

![](assets/map_big_power_stations_line_1900.jpeg){fig-align="center"}

## Grid 1911

![](assets/map_big_power_stations_line_1911.jpeg){fig-align="center"}

## Grid 1926

![](assets/map_big_power_stations_line_1926.jpeg){fig-align="center"}

## Treated parishes{#sec-treatedparishes}

![](assets/map_big_power_stations_line_1926_with_treated_parishes.jpeg){fig-align="center"}

[Why only the Western Line?](#sec-westernline){.absolute top=0 right=0}

## Treated and control parishes

![](assets/map_big_power_stations_line_1926_with_treated_and_control_parishes.jpeg){fig-align="center"}

## Location of transformers

![](assets/map_big_power_stations_line_1926_with_treated_and_control_parishes_and_transformers.jpeg){fig-align="center"}

## Location of hydro plants{#sec-hydopower}

![](assets/map_big_power_stations_line_1926_with_treated_and_control_parishes_and_hydro.jpeg){fig-align="center"}

[What about other sources of power like coal and diesel turbines?](#sec-otherpower){.absolute top=0 right=0}

## Timeline of grid rollout

```{mermaid}
flowchart TB
    subgraph Event
    Olidan-->Alvkarleby
    Alvkarleby-->WesternLine
    Olidan[Olidan Power Plant opens: 1910]
    Alvkarleby[Älvkarleby Power Plant opens: 1911]
    WesternLine[Western Line is completed: 1921]
    end

    subgraph Measure
    ElectrificationCommittee-->Census
    ElectrificationCommittee[Swedish Electrification Committee Reports produced: 1926]
    Census[Swedish census incl. income and wealth taken: 1930]
    end

    WesternLine-->ElectrificationCommittee

```

# What did early electrifiers get?{#sec-firststage background-color="#1C9E77"}

## Quasi first stage{#sec-firststagelevels}

Treated parishes have access to more electricity (KvA), controlling for parish area and population. 

![](assets/first_stage_levels.png){fig-align="center"}


```{r, eval=FALSE}
library(tidyverse)
library(gt)

regression_table <- tribble(
  ~Variable, ~Model1, ~Model2, ~Model3,
  "Treated parishes", "1303.562***", "1343.307***", "-39.745",
  "(SE)", "(348.95)", "(339.95)", "(72.49)",
  "Parish area in square kilometers", "0.000", "0.000", "-0.000",
  "(SE)", "(0.00)", "(0.00)", "(0.00)",
  "Parish population in 1900", "0.147***", "0.140***", "0.007",
  "(SE)", "(0.03)", "(0.03)", "(0.01)",
  "Constant", "13.580", "-60.639", "74.219*",
  "(SE)", "(145.55)", "(141.80)", "(30.24)"
)

# Create the tibble for additional statistics
additional_stats <- tribble(
  ~Variable, ~Model1, ~Model2, ~Model3,
  "R-squared", "0.02", "0.02", "0.00",
  "Observations", "1792", "1792", "1792",
  "F-stat", "14.009", "14.208", "0.642",
  "Mean Dependent Var", "514.24", "437.36", "76.88"
)


controls <-
  tribble(
    ~Variable, ~Model1, ~Model2, ~Model3,
    "Parish area in square kilometers", "Yes", "Yes", "Yes",
    "Parish population in 1900", "Yes", "Yes", "Yes"
  )


table <- regression_table %>% 
  filter(row_number() %in% c(1, 2)) %>% 
  bind_rows(controls) %>% 
  bind_rows(additional_stats)

table %>%
  gt() %>%
  cols_label(
    Model1 = md("(1)<br>Total power"),
    Model2 = md("(2)<br>Total power<br>(transformers)"),
    Model3 = md("(3)<br>Total power<br>(generators)")
  ) %>% 
  tab_header(title = md("**Quasi first stage**"),
             subtitle = "Total power (levels)") %>% 
  tab_footnote("Robust standard errors in parentheses") %>% 
  tab_style(
    style = cell_borders(
      sides = c("t", "b"),
      color = "grey60",
      weight = px(3)
    ),
    locations = list(cells_column_labels(), cells_stubhead())
  ) %>% 
    tab_style(
    style = cell_borders(
      sides = c("t"),
      color = "grey60",
      weight = px(2.5)
    ),
    locations =  cells_body(rows = 5)
  ) %>% 
    tab_style(
    style = cell_borders(
      sides = c("b"),
      color = "grey60",
      weight = px(3)
    ),
    locations =  cells_body(rows = 8)
  ) %>% 
  tab_options(table.font.size = "80%") %>% 
  cols_align(-Variable, align = c("center")) %>% 
  gtsave("assets/first_stage_levels.png")
```

[What about logging the outcome variable?](#sec-firststagelog){.absolute top=0 right=0}

# What happened to early electrifiers in Sweden?{#sec-happened background-color="#1C9E77"}

## Employment effects{#sec-employmentols}

If new technology automated away tasks, do we see lower rates of individuals recording an occupation?

![](assets/employment_OLS.png){fig-align="center"}

[What about using a probit?](#sec-employmentprobit){.absolute top=0 right=0}


```{r, eval=FALSE}
# Create the tibble for the regression coefficients and standard errors
regression_table <- tribble(
  ~Variable, ~Model1, ~Model2, ~Model3,
  "Birth Parish (Treated)", "-0.005*", "-0.004*", "0.002",
  "(SE)", "(0.00)", "(0.00)", "(0.00)",
  "Age", NA, "0.047***", "0.067***",
  "(SE)", NA, "(0.00)", "(0.00)",
  "Age Squared", NA, "-0.001***", "-0.001***",
  "(SE)", NA, "(0.00)", "(0.00)",
  "Female (1 = Yes 0 = No)", NA, "-0.463***", "-0.443***",
  "(SE)", NA, "(0.00)", "(0.00)",
  "Divorced", NA, NA, "0.000",
  "(SE)", NA, NA, "(.)",
  "Married", NA, NA, "-0.367***",
  "(SE)", NA, NA, "(0.01)",
  "Other", NA, NA, "-0.112",
  "(SE)", NA, NA, "(0.19)",
  "Unmarried", NA, NA, "-0.052***",
  "(SE)", NA, NA, "(0.01)",
  "Widow/Widower", NA, NA, "0.045***",
  "(SE)", NA, NA, "(0.01)",
  "Literate", NA, NA, "0.000",
  "(SE)", NA, NA, "(.)",
  "Post primary schooling", NA, NA, "0.265***",
  "(SE)", NA, NA, "(0.02)",
  "Post-secondary and university", NA, NA, "0.242***",
  "(SE)", NA, NA, "(0.03)",
  "Primary school", NA, NA, "0.286***",
  "(SE)", NA, NA, "(0.02)",
  "Constant", "0.630***", "0.264***", "-0.285***",
  "(SE)", "(0.00)", "(0.01)", "(0.03)"
)

# Create the tibble for additional statistics
additional_stats <- tribble(
  ~Variable, ~Model1, ~Model2, ~Model3,
  "R-squared", "0.00", "0.24", "0.30",
  "Observations", "770075", "770075", "770075",
  "F-stat", "5.506", "61936.779", "37819.375",
  "Mean Dependent Var", "0.63", "0.63", "0.63"
)

controls <-
  tribble(
    ~Variable, ~Model1, ~Model2, ~Model3,
    "Age and gender", "", "Yes", "Yes",
    "Marital status and schooling", "", "", "Yes"
  )


table <- regression_table %>% 
  filter(row_number() %in% c(1, 2)) %>% 
  bind_rows(controls) %>% 
  bind_rows(additional_stats)

table %>%
  gt() %>%
  cols_label(
    Model1 = md("(1)<br>Holds an occupation<br>OLS"),
    Model2 = md("(2)<br>Holds an occupation<br>OLS"),
    Model3 = md("(3)<br>Holds an occupation<br>OLS")
  ) %>% 
  tab_header(title = md("**Employment effect**"),
             subtitle = "Likelihood of recording an occupation") %>% 
  tab_footnote("Robust standard errors in parentheses") %>% 
  tab_style(
    style = cell_borders(
      sides = c("t", "b"),
      color = "grey60",
      weight = px(3)
    ),
    locations = list(cells_column_labels(), cells_stubhead())
  ) %>% 
    tab_style(
    style = cell_borders(
      sides = c("t"),
      color = "grey60",
      weight = px(2.5)
    ),
    locations =  cells_body(rows = 5)
  ) %>% 
    tab_style(
    style = cell_borders(
      sides = c("b"),
      color = "grey60",
      weight = px(3)
    ),
    locations =  cells_body(rows = 8)
  ) %>% 
  tab_options(table.font.size = "80%") %>% 
  cols_align(-Variable, align = c("center")) %>% 
  gtsave("assets/employment_OLS.png")
```

## Income effects

Do individuals with access to new technology have higher incomes than their control parish comrades?

```{r}
# Create the tibble for the regression coefficients and standard errors
regression_table <- tribble(
  ~Variable, ~Model1, ~Model2, ~Model3,
  "Birth Parish (Treated)", "0.373***", "0.312***", "0.298***",
  "(SE)", "(0.01)", "(0.01)", "(0.01)",
  "Age", NA, "0.047***", "0.067***",
  "(SE)", NA, "(0.00)", "(0.00)",
  "Age Squared", NA, "-0.001***", "-0.001***",
  "(SE)", NA, "(0.00)", "(0.00)",
  "Female (1 = Yes 0 = No)", NA, "-0.463***", "-0.443***",
  "(SE)", NA, "(0.00)", "(0.00)",
  "Divorced", NA, NA, "0.000",
  "(SE)", NA, NA, "(.)",
  "Married", NA, NA, "-0.367***",
  "(SE)", NA, NA, "(0.01)",
  "Other", NA, NA, "-0.112",
  "(SE)", NA, NA, "(0.19)",
  "Unmarried", NA, NA, "-0.052***",
  "(SE)", NA, NA, "(0.01)",
  "Widow/Widower", NA, NA, "0.045***",
  "(SE)", NA, NA, "(0.01)",
  "Literate", NA, NA, "0.000",
  "(SE)", NA, NA, "(.)",
  "Post primary schooling", NA, NA, "0.265***",
  "(SE)", NA, NA, "(0.02)",
  "Post-secondary and university", NA, NA, "0.242***",
  "(SE)", NA, NA, "(0.03)",
  "Primary school", NA, NA, "0.286***",
  "(SE)", NA, NA, "(0.02)",
  "Constant", "0.630***", "0.264***", "-0.285***",
  "(SE)", "(0.00)", "(0.01)", "(0.03)"
)

# Create the tibble for additional statistics
additional_stats <- tribble(
  ~Variable, ~Model1, ~Model2, ~Model3,
  "R-squared", "0.00", "0.24", "0.30",
  "Observations", "770075", "770075", "770075",
  "F-stat", "5.506", "61936.779", "37819.375",
  "Mean Dependent Var", "0.63", "0.63", "0.63"
)

controls <-
  tribble(
    ~Variable, ~Model1, ~Model2, ~Model3,
    "Age and gender", "", "Yes", "Yes",
    "Marital status and schooling", "", "", "Yes"
  )


table <- regression_table %>% 
  filter(row_number() %in% c(1, 2)) %>% 
  bind_rows(controls) %>% 
  bind_rows(additional_stats)

table %>%
  gt() %>%
  cols_label(
    Model1 = md("(1)<br>Holds an occupation<br>OLS"),
    Model2 = md("(2)<br>Holds an occupation<br>OLS"),
    Model3 = md("(3)<br>Holds an occupation<br>OLS")
  ) %>% 
  tab_header(title = md("**Employment effect**"),
             subtitle = "Likelihood of recording an occupation") %>% 
  tab_footnote("Robust standard errors in parentheses") %>% 
  tab_style(
    style = cell_borders(
      sides = c("t", "b"),
      color = "grey60",
      weight = px(3)
    ),
    locations = list(cells_column_labels(), cells_stubhead())
  ) %>% 
    tab_style(
    style = cell_borders(
      sides = c("t"),
      color = "grey60",
      weight = px(2.5)
    ),
    locations =  cells_body(rows = 5)
  ) %>% 
    tab_style(
    style = cell_borders(
      sides = c("b"),
      color = "grey60",
      weight = px(3)
    ),
    locations =  cells_body(rows = 8)
  ) %>% 
  tab_options(table.font.size = "80%") %>% 
  cols_align(-Variable, align = c("center")) %>% 
  gtsave("assets/employment_OLS.png")
```


## Inequality effects

At the parish level, do we see a more equal distribution of income among the treated parishes?

# What are the mechanisms that drive these effects?




# Findings{#sec-findings background-color="#1C9E77"}

## We find that when this new technology was adopted in Sweden:

- It made individuals richer 💰🔋
- It lowered inequality 📉🤝
- It allowed structural change on the labor market 🔧💼
- It created new kinds of jobs 🤖👩‍🔧
- It benefitted those in the middle of the skill distribution 🎓🔌


## Rollout

![](assets/grid_rollout.jpg){fig-align="center"}

## No large unemployment effects in areas who electrified first

![](assets/share_reporting_jobs.jpeg){fig-align="center"}

## Incomes were markedly higher in areas that electrified first

![](assets/coef_plot.jpeg){fig-align="center"}

## Income was shared more equally in areas that electrified first

![](assets/dot_plot.jpeg){fig-align="center"} 

## What were the mechanisms behind these effects?

![](assets/job_share_plot.jpeg){fig-align="center"} 

## What are the new jobs that were created?

![](assets/new_jobs_1930.jpeg){fig-align="center"}

```{r}
#| eval: false

library(tidyverse)
theme_set(theme_light())
library(ggtext)
library(showtext)
## Loading Google fonts (https://fonts.google.com/)
font_add_google("IBM Plex Mono", "ibm")
font_add_google("Roboto", "roboto")

showtext_opts(dpi = 300)
showtext_auto(enable = TRUE)


data <- tribble(
  ~occupation, ~employees, ~classification,
  "Electrical Fitter, General", 1000, "Medium-skilled",
  "Automobile Mechanic", 750, "Medium-skilled",
  "Operations Manager (Postal or Telecommunications Services)", 600, "Higher Manager",
  "Wood Grader", 300, "Lower-skilled",
  "Woodworking Machine Operator, General", 250, "Lower-skilled",
  "Loom Fixer", 240, "Medium-skilled",
  "Show Worker, Specialization Unknown", 230, "Lower-skilled",
  "Waste Collector", 200, "Unskilled",
  "Power-Generating Machine Operator", 200, "Medium-skilled",
  "Welder, General", 180, "Lower-skilled",
  "Pharmaceutical Assistant", 150, "Lower-skilled",
  "Blast Furnace (Ore Smelting)", 120, "Lower-skilled",
  "Highway and Street Construction Engineer", 100, "Higher Professional",
  "Lace Weaver, Machine", 80, "Lower-skilled",
  "Fiber Mixer and Blender", 50, "Lower-skilled",
  "Technical Salesman", 40, "Medium-skilled"
)

# Convert strings to title case
data$occupation <- tools::toTitleCase(data$occupation)

order <- c("Higher Manager", "Higher Professional", "Medium-skilled", "Lower-skilled")

order_tbl <- tibble(classification = order, order = 1:length(order))

# join data and order tbl
data <- data %>%
  left_join(order_tbl, by = "classification")

data %>%
  mutate(occupation = fct_reorder(occupation, employees)) %>%
  filter(classification != "Unskilled") %>%
  mutate(classification = fct_reorder(classification, order)) %>%
  ggplot(aes(x = occupation, y = employees, fill = classification)) +
  geom_col(alpha = .8) +
  coord_flip() +
  labs(x = NULL, y = "Number of employees", title = "New occupations created in Sweden 1910-1930", fill = "Job type") +
  scale_fill_brewer(palette = "Dark2") +
  theme(
    # panel.grid.major.y = element_blank(),
    panel.grid.minor.y = element_blank(),
    panel.grid.minor.x = element_blank(),
    plot.title = element_markdown(size = 32, family = 'roboto'),
    plot.title.position = "plot",
    legend.position = "right",
    text = element_text(family = 'ibm', size = 18)
  ) 


ggsave(filename = here::here("assets/new_jobs_1930.jpeg"), device = "jpeg", width = 450, height = 231, units = "mm", dpi = 300)


employment <- tibble(group = c("Treated", "Control"), employment_share = c(0.6123, 0.6070))

# ggplot column plot with employment
employment %>%
  mutate(employment_share_lab = scales::percent(employment_share)) %>%
  ggplot(aes(y = group, x = employment_share, fill = group)) +
  geom_col(alpha = .8) +
  geom_text(aes(label = employment_share_lab), cex = 8, hjust = -0.1) +
  labs(y = NULL, x = "Share reporting income and occupation", 
  title = "Working age population with occupation and income <br> in <b><span style = 'color:#9C6114;'>treated</span></b> and 
                          <b><span style = 'color:#000080;'>control</span></b> parishes in 1930", fill = NULL) +
  scale_fill_manual(values = c("#000080", "#9C6114")) +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1), limits = c(NA, 1)) +
  theme(
    # panel.grid.major.y = element_blank(),
    panel.grid.minor.y = element_blank(),
    panel.grid.minor.x = element_blank(),
    plot.title = element_markdown(size = 32, family = 'roboto'),
    plot.title.position = "plot",
    legend.position = "none",
    text = element_text(family = 'ibm', size = 18)
  )

ggsave(filename = here::here("assets/share_reporting_jobs.jpeg"), device = "jpeg", width = 290, height = 231, units = "mm", dpi = 300)
```

## What can we learn from this era of technological change?

1. New kinds of jobs were created with the new technology 🎛️👩‍💻

2. The new jobs were not necessarily high-skilled 🎓⬇️
    - learning by doing / on the job training 🧑‍🔧💡
    - creation of middle-skilled jobs 👨‍💼🔨

3. It met people where they were 📍🤝
    - the new jobs were created in the same areas as the old jobs 🏭➡️🏢

<br>

### Why is this time different? 🕰️🔄🤔

##

::: {style="text-align: center"}

<br>
<br>

<br>
<br>

Questions
:::

# Appendix{#sec-appendix background-color="#D95F02"}

## Importance of Western Line{#sec-westernline}

![](assets/1922_power_lines.jpg){fig-align="center"}

[Back to treated parishes](#sec-treatedparishes){.absolute top=0 right=0}

## Location of steam and diesel plants{#sec-otherpower}

[Back to hydropower](#sec-hydopower){.absolute top=0 right=0}

<br>

:::: {.columns}

::: {.column width="45%"}
![](assets/map_big_power_stations_line_1926_with_treated_and_control_parishes_and_diesel.jpeg){fig-align="center" width=70%}


:::

::: {.column width="10%"}
:::

::: {.column width="45%"}
![](assets/map_big_power_stations_line_1926_with_treated_and_control_parishes_and_steam.jpeg){fig-align="center" width=70%}
:::

::::


## Quasi first stage{#sec-firststagelog}

![](assets/first_stage_log.png){fig-align="center"}

[Back to first stage in levels](#sec-firststagelevels){.absolute top=0 right=0}

```{r, eval=FALSE}
# Create the tibble
regression_table <- tribble(
  ~Variable, ~Model1, ~Model2, ~Model3,
  "Treated parishes", "0.920***", "0.973***", "1.158",
  "(SE)", "(0.28)", "(0.29)", "(0.65)",
  "Parish area in square kilometers", "0.000", "0.000", "-0.000*",
  "(SE)", "(0.00)", "(0.00)", "(0.00)",
  "Parish population in 1900", "0.000***", "0.000***", "0.000",
  "(SE)", "(0.00)", "(0.00)", "(0.00)",
  "Constant", "4.586***", "4.419***", "5.366***",
  "(SE)", "(0.12)", "(0.12)", "(0.32)"
)

# Add additional statistics
additional_stats <- tribble(
  ~Variable, ~Model1, ~Model2, ~Model3,
  "R-squared", "0.12", "0.11", "0.10",
  "Observations", "511", "511", "511",
  "F-stat", "22.712", "19.937", "3.119",
  "Mean Dependent Var", "5.25", "5.08", "5.45"
)

controls <-
  tribble(
    ~Variable, ~Model1, ~Model2, ~Model3,
    "Parish area in square kilometers", "Yes", "Yes", "Yes",
    "Parish population in 1900", "Yes", "Yes", "Yes"
  )


table <- regression_table %>% 
  filter(row_number() %in% c(1, 2)) %>% 
  bind_rows(controls) %>% 
  bind_rows(additional_stats)

table %>%
  gt() %>%
  cols_label(
    Model1 = md("(1)<br>Ln total power"),
    Model2 = md("(2)<br>Ln total power<br>(transformers)"),
    Model3 = md("(3)<br>Ln total power<br>(generators)")
  ) %>% 
  tab_header(title = md("**Quasi first stage**"),
             subtitle = "Total power (logged)") %>% 
  tab_footnote("Robust standard errors in parentheses") %>% 
  tab_style(
    style = cell_borders(
      sides = c("t", "b"),
      color = "grey60",
      weight = px(3)
    ),
    locations = list(cells_column_labels(), cells_stubhead())
  ) %>% 
    tab_style(
    style = cell_borders(
      sides = c("t"),
      color = "grey60",
      weight = px(2.5)
    ),
    locations =  cells_body(rows = 5)
  ) %>% 
    tab_style(
    style = cell_borders(
      sides = c("b"),
      color = "grey60",
      weight = px(3)
    ),
    locations =  cells_body(rows = 8)
  ) %>% 
  tab_options(table.font.size = "80%") %>% 
  cols_align(-Variable, align = c("center")) %>% 
  gtsave("assets/first_stage_log.png")
```

## Employment effect{#sec-employmentprobit}

![](assets/employment_probit.png){fig-align="center"}

[Back to employment OLS](#sec-employmentols){.absolute top=0 right=0}

```{r, eval=FALSE}
# Create the tibble for the regression coefficients and standard errors
regression_table <- tribble(
  ~Variable, ~Model1, ~Model2, ~Model3,
  "Birth Parish (Treated)", "-0.014*", "-0.011", "0.012",
  "(SE)", "(0.01)", "(0.01)", "(0.01)",
  "Age", NA, "0.047***", "0.067***",
  "(SE)", NA, "(0.00)", "(0.00)",
  "Age Squared", NA, "-0.001***", "-0.001***",
  "(SE)", NA, "(0.00)", "(0.00)",
  "Female (1 = Yes 0 = No)", NA, "-0.463***", "-0.443***",
  "(SE)", NA, "(0.00)", "(0.00)",
  "Divorced", NA, NA, "0.000",
  "(SE)", NA, NA, "(.)",
  "Married", NA, NA, "-0.367***",
  "(SE)", NA, NA, "(0.01)",
  "Other", NA, NA, "-0.112",
  "(SE)", NA, NA, "(0.19)",
  "Unmarried", NA, NA, "-0.052***",
  "(SE)", NA, NA, "(0.01)",
  "Widow/Widower", NA, NA, "0.045***",
  "(SE)", NA, NA, "(0.01)",
  "Literate", NA, NA, "0.000",
  "(SE)", NA, NA, "(.)",
  "Post primary schooling", NA, NA, "0.265***",
  "(SE)", NA, NA, "(0.02)",
  "Post-secondary and university", NA, NA, "0.242***",
  "(SE)", NA, NA, "(0.03)",
  "Primary school", NA, NA, "0.286***",
  "(SE)", NA, NA, "(0.02)",
  "Constant", "0.630***", "0.264***", "-0.285***",
  "(SE)", "(0.00)", "(0.01)", "(0.03)"
)

# Create the tibble for additional statistics
additional_stats <- tribble(
  ~Variable, ~Model1, ~Model2, ~Model3,
  "R-squared", "0.00", "0.24", "0.30",
  "Observations", "770075", "770075", "770075",
  "F-stat", "5.506", "61936.779", "37819.375",
  "Mean Dependent Var", "0.63", "0.63", "0.63"
)

controls <-
  tribble(
    ~Variable, ~Model1, ~Model2, ~Model3,
    "Age and gender", "", "Yes", "Yes",
    "Marital status and schooling", "", "", "Yes"
  )


table <- regression_table %>% 
  filter(row_number() %in% c(1, 2)) %>% 
  bind_rows(controls) %>% 
  bind_rows(additional_stats)

table %>%
  gt() %>%
  cols_label(
    Model1 = md("(1)<br>Holds an occupation<br>Probit"),
    Model2 = md("(2)<br>Holds an occupation<br>Probit"),
    Model3 = md("(3)<br>Holds an occupation<br>Probit")
  ) %>% 
  tab_header(title = md("**Employment effect**"),
             subtitle = "Likelihood of recording an occupation") %>% 
  tab_footnote("Robust standard errors in parentheses") %>% 
  tab_style(
    style = cell_borders(
      sides = c("t", "b"),
      color = "grey60",
      weight = px(3)
    ),
    locations = list(cells_column_labels(), cells_stubhead())
  ) %>% 
    tab_style(
    style = cell_borders(
      sides = c("t"),
      color = "grey60",
      weight = px(2.5)
    ),
    locations =  cells_body(rows = 5)
  ) %>% 
    tab_style(
    style = cell_borders(
      sides = c("b"),
      color = "grey60",
      weight = px(3)
    ),
    locations =  cells_body(rows = 8)
  ) %>% 
  tab_options(table.font.size = "80%") %>% 
  cols_align(-Variable, align = c("center")) %>% 
  gtsave("assets/employment_probit.png")
```



## Final slide

